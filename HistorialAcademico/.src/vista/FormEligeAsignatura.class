' Gambas class file

Private resultadoCurso As Result
Public cursoelegido As ClaseDato
Public ControladorAplicacion As Controlador

Public Sub Form_Show()
  
  Dim curs As New Cursodao
  
  curs.gridFormatearColumnas(GridViewAsignatura)
  RevisarAnchos(GridViewAsignatura)
  
  RefrescarDatosCurso()
  
End

Public Sub ToolButtonCancelar_Click()
  
  Me.Close()
  Return
  
End

Public Sub ToolButtonAceptar_Click()
  
  If GridViewAsignatura.row = -1 Then 
    Message.Info("No ha seleccinado ningun curso, y no se añadira nada al alumno")
    Return 
  Else
    '  Debug "curso elegido: ", GridViewCurso[GridViewCurso.row, 0].text
    cursoelegido.tag = GridViewAsignatura[GridViewAsignatura.row, 0].text
    Me.Close()
    Return
  Endif
  
End

Public Sub RefrescarDatosCurso()
  
  resultadoCurso = ControladorAplicacion.ContenidoCurso()
  GridViewAsignatura.Rows.count = 0 'lo ponemos a cero el numero de filas
  GridViewAsignatura.Rows.count = resultadoCurso.count 'actualizamso al resultado de la consulta
  
End

Public Sub GridViewAsignatura_Data(row As Integer, column As Integer)
  ' este evento se encarga de dibujar los datos en el gridviews, para que aparezcan en la pantalla.
  
  resultadoCurso.MoveTo(row)
  GridViewAsignatura.Data.text = Str(resultadoCurso[GridViewAsignatura.Columns[column].text])
  
  ' colorea la fila, según sea par o impar
  If row = GridViewAsignatura.row Then 
    'cursor donde esta situado en el gridview
    GridViewAsignatura.Data.Background = Color.Orange
  Else
    If row Mod 2 = 0 Then GridViewAsignatura.Data.Background = Color.Cyan
  Endif
  
End

Public Sub Form_Open()
  
End
'reviso anchos de las columnas

Public Sub RevisarAnchos(rejilla As GridView)
  
  With rejilla 
    
    .Columns[0].width = 0
    
  End With
  
End
